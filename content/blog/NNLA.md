---
title: Neural Networks with Linear Algebra
description: <i>f</i>(Linear Algebra) -> Neural Networks
date: 2023-10-24
---

The following essay will be an attempt in looking at Neural Networks through the lens of Linear Algebra. Neural Networks (or Machine Learning in general) are mathematically defined and can also be seen as an application of Linear Algeba itself, with the amalgation of calculus resulting in Vector Calculus. Learning this topic through a mathematical viewpoint often leads to understanding of the why of Neural Networks (or Machine Learning in general), why certain formulas are applied/used, and why they are effective. The knowledge behind how is mostly grounded in computer science, and fascinating though it is, I will mostly try to avoid it. The programming, data structures and algorithms utilized for implementing the concepts in Linear Algebra will not be covered in this essay. 

## Part I

Neural Networks, in the most rudimentary sense, take in an input, and return an output. The output is generally termed as a prediction. The output can be the same variable as an input, as in predicting tomorrow's stock price, or it can be something different, i.e, if a given image is a cat or a dog (the input being image). What does a Neural Network do ? For now, it takes in a number, multiples it with another number, and gives an output.

<math display="block" class="tml-display" style="display:block math;"><mrow><mo form="prefix" stretchy="false">[</mo><mi>x</mi><mo form="postfix" stretchy="false">]</mo><mo form="prefix" stretchy="false">[</mo><mi>w</mi><mo form="postfix" stretchy="false">]</mo><mo>=</mo><mo form="prefix" stretchy="false">[</mo><mi>o</mi><mo form="postfix" stretchy="false">]</mo></mrow></math>
<br>

Above, X is the input, W is the number to be multiplied, termed as a weight, and O is the output. This is the beginning of any Neural Network, take the input and multiply it by the weight. The output is the prediction. We have predicted something (however wrong it may be) and must therefore somehow check how wrong or far from the true value we are. This can be achieved by comparing our prediction with the true value. It is the actual value of the thing we are trying to predict. For example, we predicted a dog, but what actually was the image? Or what was today's actual stock price ? We compare our output, with the actual value of the variable. How ? Well there are many ways. In fact, how we calculate the error is extremely crucial, so much so that it can actually help you nudge the Neural Network in the direction you want it to learn ! In this case, we simply take the difference, 

<math display="block" class="tml-display" style="display:block math;"><mrow><mo form="prefix" stretchy="false">[</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>o</mi><mo form="postfix" stretchy="false">]</mo></mrow></math>
<br>

Both variables being numbers, the result can take any real integer value. The error has another term: Loss function. But there is a problem, that the error can take negative values. We only want the distance (how *much*) between the prediction and the true value, not the direction (yet). Therefore, we simply square the value,

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><mo form="prefix" stretchy="false">[</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mo>−</mo><mtext> </mtext><mi>o</mi><msup><mo form="postfix" stretchy="false">]</mo><mn>2</mn></msup></mrow></math>
<br>

This is the complete loss function. Math is simple isn't it ? Now let's continue further. You may be wondering, what is so "Linear Algebra" about this? Well here it is. I have restricted the *size* of the input (or the output), but the input can also be a *Vector*. 

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>X</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>x</mi><mn>1</mn></msub></mtd><mtd><msub><mi>x</mi><mn>2</mn></msub></mtd><mtd><msub><mi>x</mi><mn>3</mn></msub></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></math>
<br>

The *T* indicates that it's a column vector (not a rule, but is generally used) so it's a notation for transpose. The output can also be a vector, though it depends on what we are trying to predict. In some cases, it's a single variable and in others, it's a vector. Now because of the laws of matrices, our prediction are,

<math display="block" class="tml-display" style="display:block math;"><mrow><msubsup><mrow><mo stretchy="true" fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>12</mn></msub></mtd><mtd><msub><mi>w</mi><mn>13</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>21</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>31</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mi>n</mi><mo>* </mo><mi>z</mi></mrow></msub><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></math>
<math display="block" class="tml-display" style="display:block math;"><mrow><mi>n</mi><mo separator="true">,</mo><mi>z</mi><mtext> </mtext><mo>∈</mo><mtext> </mtext><mi>ℕ</mi></mrow></math>
<br>

The dimensions of the weight are easy to calculate, they are simply (*number of elements of Input x number of elements of Output*). Here, we are at the beginning of Linear Algebra. We normally also add in some weights, as it helps in getting more accurate results. 

<math display="block" class="tml-display" style="display:block math;"><mrow><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>12</mn></msub></mtd><mtd><msub><mi>w</mi><mn>13</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>21</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>31</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mi>n</mi><mo>* </mo><mi>z</mi></mrow></msub><mo>+</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></math>
<br>

The column vectors with *b*'s in it is called the bias or the bias vector. Since it is an addition, it has the same dimensions as the output, and lastly, our Loss function becomes,

<math display="block" class="tml-display" style="display:block math;"><mrow><mrow><mo fence="true" form="prefix">(</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo>−</mo><mtext> </mtext><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>e</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup></mrow></math>
<br>

But, this returns another vector. What we are looking for is a single number to measure the overall loss of the *entire* network, not just indivisual values. Thus we simply add all the elements in the resultant vector, and divide it by the number of elements, in other words, take the average.

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mtext>​</mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mfrac><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><msub><mi>e</mi><mi>i</mi></msub></mrow><mi>z</mi></mfrac></mrow></math>
<br>

With this, we have a loss function with multi-dimensional outputs. This particular loss function is called the Mean Squared Error (MSE). The MSE is *how* bad our prediction is. The bigger the loss, worse is the prediction, and hence, we must somehow *reduce* or *minimize* the error. This brings us to perhaps the most crucial part of Machine Learning, or Artificial Intelligence in general, the *Learning* part. By somehow minimizing this error, the network *learns* from it's mistakes, and makes better and better predictions. But how ? How do we reduce the error ? The answer is hidden in calculus.

## Part II

What is a derivative ? It is the slope of a curved line. But another way of looking at it, is that a derivative is simply a way to establish a relationship between a function, and it's variables. Let's see a simple example,

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>y</mi><mo>=</mo><msup><mi>w</mi><mn>2</mn></msup><mtext> </mtext><mtext> </mtext><mi>o</mi><mi>r</mi><mtext> </mtext><mi>f</mi><mo form="prefix" stretchy="false">(</mo><mi>x</mi><mo form="postfix" stretchy="false">)</mo><mo>=</mo><mi>w</mi><msup><mtext>​</mtext><mn>2</mn></msup></mrow></math>
<br>

A function contains a variable, *W*. The variable changes. How much, and in which direction will the function change ? If we change *W*, how will the function f(*W*) or W<sup>2</sup> change ? If *W* is 4, the function is 16. If *W* is 6, the function is 36. Here, we have to encapture how much and in which direction does the function change. The answer is to find the derivative of the function with respect to *W*. The formulas and intuitions won't be explained here, but the derivative is 2*W* in this case. It is denoted by *d/dw*.

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>f</mi><mo form="prefix" stretchy="false">(</mo><mi>x</mi><mo form="postfix" stretchy="false">)</mo><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>2</mn><mi>w</mi></mrow></math>
<br>

A function with multiple inputs ? Same answer. Find the derivative with respect to the variable concerned.

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>z</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><msup><mi>w</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></math>
<br>

For Y's impact on Z, we find, 
 
<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mi>δ</mi><mrow><mi>δ</mi><mi>y</mi></mrow></mfrac><mi>Z</mi><mo>=</mo><mn>2</mn><mi>y</mi></mrow></math>
<br>

For W's impact on Z, we find, 
 
<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mi>δ</mi><mrow><mi>δ</mi><mi>w</mi></mrow></mfrac><mi>Z</mi><mo>=</mo><mn>2</mn><mi>w</mi></mrow></math>
<br>

The method or steps to calculate derivatives, normal or partial (with multiple variables) are simple enough, so I won't be going through them in this essay. The derivative of *W*  and *Y* basically tells us that if we increase them by one unit, how much will it affect *Z*, will it increase ? or decrease ? and by how much ? From the example above, we see that if *W* increases, *Z* multiplies by 2 times *W*, same with *Y*. Imagine, that *Z* is the loss function, and *W* and *Y* are variables we can control. This means that if we tweak them properly, we can minimize the loss ! If we tweak the *W* and *Y* variables in a certain direction by a certain amount, the result will be a decrease in the loss function (which is *Z* in this case). The change/tweak in those variables will basically be a decrement by their derivatives. 

<math display="block" class="tml-display" style="display:block math;"><mtable columnalign="left"><mtr><mtd style="padding:0.5ex 0em 0.5ex 0em;text-align:-webkit-left;"><mrow><mi>W</mi><mo>−</mo><mfrac><mi>δ</mi><mrow><mi>δ</mi><mi>y</mi></mrow></mfrac><mi>Z</mi></mrow></mtd></mtr><mtr><mtd style="padding:0.5ex 0em 0.5ex 0em;text-align:-webkit-left;"><mrow><mi>Y</mi><mo>−</mo><mfrac><mi>δ</mi><mrow><mi>δ</mi><mi>w</mi></mrow></mfrac><mi>Z</mi></mrow></mtd></mtr></mtable></math>
<br>

By doing the above mentioned operation, we have decreased the loss ! Or decreased the *Z* function. Now, let us compare this to our original equations. *Z* is the loss, let *W* be the weights and *Y* be the bias. 

<math display="block" class="tml-display" style="display:block math;"><mrow><mi>Z</mi><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>*  </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo>−</mo><mtext> </mtext><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>p</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mtext> </mtext><mtext> </mtext><mi>W</mi><mo>=</mo><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>21</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>31</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mi>n</mi><mo>* </mo><mi>z</mi></mrow></msub><mi>Y</mi><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup></mrow></math>
<br>

But first, let's pull *W* and *Y* into the *Z* equation, or write the loss function in terms of weights and bias.
 

<math display="block" class="tml-display" style="display:block math;"><mtable columnalign="left"><mtr><mtd style="padding:0.5ex 0em 0.5ex 0em;text-align:-webkit-left;"><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><mo form="prefix" stretchy="false">(</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>−</mo><mo form="prefix" stretchy="false">(</mo><mi>I</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mo>* </mo><mi>W</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>s</mi><mtext> </mtext><mo>+</mo><mtext> </mtext><mi>B</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo form="postfix" stretchy="false">)</mo><msup><mo form="postfix" stretchy="false">)</mo><mn>2</mn></msup></mrow></mtd></mtr><mtr><mtd style="padding:0.5ex 0em 0.5ex 0em;text-align:-webkit-left;"><mrow><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><msup><mrow><mo fence="true" form="prefix">(</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>t</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo>−</mo><mtext> </mtext><mrow><mo fence="true" form="prefix">(</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>n</mi></mrow><mi>T</mi></msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>21</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>31</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mo>+</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo fence="true" form="postfix">)</mo></mrow><mo fence="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>z</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>z</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>z</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>z</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup></mrow></mtd></mtr></mtable></math>
<br>

Now ? Find the derivatives. The word for derivatives is gradient. Thus we say the gradient of *W* or Y, and subtract it from the weights and biases. How do we look for the gradients of a vector? And a matrix ? When we have a vector or matrix on hand, to be differentiated with another vector or matrix, we inevitably have to do them elementwise (computers do them, we code). A vector/Matrix when differentiated with another vector/Matrix, will simply result in a vector/Matrix. This new vector/Matrix is called the Jacobian matrix, it contains all the gradients of each indivisual weights and baises. Quick reminder, if you solve the above Loss function equation, you will end up with a (1xz) dimensional vector (it has all the losses in it). We can do the averaging here to know the overall loss, although it is not needed for further computation. Let's start with the bias vector. *Y* is (1xz) dimensional vector, same as our Loss function output *Z*. 

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>1</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>1</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>2</mn></msub></mrow></mfrac></mtd><mtd><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>1</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>3</mn></msub></mrow></mfrac></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>1</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mi>z</mi></msub></mrow></mfrac></mtd></mtr><mtr><mtd style="padding-left:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>2</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>3</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>z</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>z</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mi>z</mi></msub></mrow></mfrac></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mi>z</mi><mo>* </mo><mi>z</mi></mrow></msub></mrow></math>
<br>

This is the Jacobain of *Y* with *Z* as the function. The next step requires us to subtract this with the Bias vector *Y*. But notice how the dimensions don't match ? That is because we have found the gradient of each and every element of *Y* with each and every element of *Z*. For example, y<sub>1</sub>'s impact on every element of Z has been calculated, on z<sub>1</sub>,z<sub>2</sub>,z<sub>3</sub>,... . We need to add them up, to get it's overall impact.

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>1</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>2</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mn>3</mn></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac><mo>+</mo><mo>…</mo><mo>+</mo><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>z</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mrow></math>
<br>

hence,

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mtext> </mtext><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></munderover></mrow><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mrow></math>
<br>

with relation to the matrix, we have to do a row-wise addition,

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>3</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mi>z</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow></msub></mrow></math>
<br>

we got the required gradient ! Now all that remians is to subtract it with the original Bias vector, to get our new Bias vector, *Y*<sup>* </sup>

<math display="block" class="tml-display" style="display:block math;"><mrow><msup><mi>Y</mi><mo lspace="0em" rspace="0em">* </mo></msup><mo>=</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><msub><mi>b</mi><mi>z</mi></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup><mo>−</mo><msubsup><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center"><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>1</mn></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>2</mn></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mn>3</mn></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>y</mi><mi>z</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mn>1</mn><mo>* </mo><mi>z</mi></mrow><mi>T</mi></msubsup></mrow></math>
<br>

<strong>Note: The dimensions are of the vector after tranpose.</strong>

Now we shall repeat the step with the weight Matrix. At first glance, the gradient of a weight matrix seems tricky. We have to calculate the gradient of a matrix in relation to a vector. The resulting product will not be a Jacobian Matrix, but a three-dimensional Jacobian Tensor (I have taken the liberty to coin this term myself, as I've not come across any other term). The dimensions of the Jacobian Tensor will be (*n* x *z* x *z*).  Without delay let's visualize what a Jacobian Tensor would look like, 

<img src='/media/Jacobian Tensor.png'>

As we did before, we have to transform the Jacobian Tensor of dimensions *n* x *z* x *z* into a *n* x *z* matrix, with addition on the third dimension. We need to look for the overall contribution of each element of the weight matrix, namely every w<sub>ij</sub> element of the weight matrix, hence just like before, we have,

<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mtext> </mtext><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></munderover></mrow><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow></math>
<br>

and hence, finally we get the Jacobian Matrix of the weights, in relation with the loss function.
 
<math display="block" class="tml-display" style="display:block math;"><mrow><mfrac><mrow><mi>δ</mi><mi>Z</mi></mrow><mrow><mi>δ</mi><mi>W</mi></mrow></mfrac><mo>=</mo><msub><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>11</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>12</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>13</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>21</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>31</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mrow><mi>n</mi><mo>* </mo><mi>z</mi></mrow></msub></mrow></math>
<br>

And as we did before, we decrease our weight values by the *Jacobian* of *W*.

<math display="block" class="tml-display" style="display:block math;"><mrow><msup><mi>W</mi><mo lspace="0em" rspace="0em">* </mo></msup><mtext> </mtext><mo>=</mo><mtext> </mtext><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><msub><mi>w</mi><mn>11</mn></msub></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>21</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mn>31</mn></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><msub><mi>w</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow><mo>−</mo><mtext> </mtext><mrow><mo fence="true" form="prefix">[</mo><mtable columnalign="center center center center center"><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>11</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>12</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>13</mn></msub></mrow></mfrac></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd style="padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mn>1</mn><mi>z</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>21</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mn>31</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">⋱</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><mi>⋮</mi><mspace width="0pt" height="14.944pt"></mspace></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow></mrow></mtd></mtr><mtr><mtd style="padding-left:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow></mrow></mtd><mtd><mo lspace="0em" rspace="0em">…</mo></mtd><mtd><mrow></mrow></mtd><mtd style="padding-right:0em;"><mrow><msubsup><mo movablelimits="false">∑</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mi>z</mi></msubsup><mfrac><mrow><mi>δ</mi><msub><mi>z</mi><mi>x</mi></msub></mrow><mrow><mi>δ</mi><msub><mi>w</mi><mrow><mi>n</mi><mi>z</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true" form="postfix">]</mo></mrow></mrow></math>
<br>

With this final step, we have the new weights *W*<sup>* </sup> and the new baises *Y*<sup>* </sup>.  These new weights and biases can be used to ounce again calculate a new output, which can be again compared with the actual values, taken gradients of and repeat the process. Since the new weights and biases mathematically give us a lower loss function, in theory, if we keep doing it, we will eventaully make the loss zero (although in real-life applications, that is undesired for reasons that will not be covered here).

<p style="text-align: center;">
<i><a href="/blog/nnla2/">Continure Reading</a></i>
<br>
<strong><a href='/'>Home</a></strong>
</p>
